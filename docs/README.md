# Windows-Base
Windowsアプリケーションの基本ライブラリ。

## ソリューションの設定
ソリューションのプロパティを開き、`共通プロパティ->スタートアッププロジェクトの構成`を現在の選択範囲に変更する。これはgit上で反映されないため、自身の環境で行う必要がある。これをすることで、ソリューションエクスプローラー上で実行したいプロジェクトを選択し、デバッグなどを実行すると、そのプロジェクトが実行されるようにできる。

## ライブラリの作成手順
1. ソリューションへ新しいプロジェクト`Windowsデスクトップウィザード`をアプリケーションの種類`ダイナミックリンクライブラリ`、追加のオプション`空のプロジェクト`で作成
2. 作成したプロジェクトのプロパティから、`構成プロパティ->VC++ディレクトリ`を選択、構成が`すべての構成`、プラットフォームが`x64` になっていることを確認し以下を変更
   1. `インクルードディレクトリ`を編集し、以下を追加
      1. `$(SolutionDir)`
      2. DirectXTK12を使う場合は、`$(SolutionDir)directxtk12\include\`
      3. DirectX12関連の配布されているヘルパー関数を使う場合は、`$(SolutionDir)directx12_helper\include\`
   2. `ライブラリディレクトリ`を編集し、以下を追加
      1. `$(SolutionDir)$(Platform)\$(Configuration)\`
      2. DirectXTK12を使う場合は、`$(SolutionDir)directxtk12\bin\$(Platform)\$(Configuration)\`
3. 作成したプロジェクトのプロパティから、`構成プロパティ->全般`を選択、構成が`すべての構成`、プラットフォームが`x64` になっていることを確認し以下を変更
   1. `C++言語標準`を`C++17`に変更
4. エクスプローラーやVSCodeでフォルダを開き、`.vcxproj`ファイルがあるディレクトリに以下のフォルダーを作成
   1. include
   2. src
5. エクスプローラーやVSCodeでフォルダを開き、`src`フォルダ内に以下をファイルらを作成
   1. pch.h
   2. pch.cpp
6. `pch.h`では`#pragma once`を、`pch.cpp`では`pch.h`をインクルードする
7. Visual Studioの`ソースファイルフィルター`に`追加->既存の項目`で以下を追加
   1. pch.h
   2. pch.cpp
8. 作成したプロジェクトのプロパティから、`構成プロパティ->C/C++->プリコンパイル済みヘッダー`を選択、構成が`すべての構成`、プラットフォームが`x64` になっていることを確認し以下を変更
   1. `プリコンパイル済みヘッダー`を`使用`に変更
   2. `プリコンパイル済みヘッダーファイル`を`$(ProjectName)\src\pch.h`に変更
9.  `pch.cpp`ファイルのプロパティから、`構成プロパティ->C/C++->プリコンパイル済みヘッダー`を選択、構成が`すべての構成`、プラットフォームが`x64` になっていることを確認し以下を変更
    1.  `プリコンパイル済みヘッダー`を`作成`に変更
10. 他のライブラリを使用する場合、Visual Studioのソリューションエクスプローラー上のプロジェクトの下にある、`参照`から`参照の追加`をし、使用するDLLライブラリのプロジェクトを追加する
11. `include`フォルダに`dll_config.h`を作成し、以下のようにDLLのエクスポートを設定する
```C++
#pragma once

#define BUILDING_モジュール名_DLL
#ifdef BUILDING_モジュール名_DLL
#define モジュール名_API __declspec(dllexport)
#else
#define モジュール名_API __declspec(dllimport)
#endif
```
12. `include`、`src`フォルダ内にファイルらを作成する
13. クラス、関数には必ず以下のようにエクスポート属性を付ける
```C++
class モジュール名_API ExampleClass
{

};

モジュール名_API void ExampleFunction()
{
    
}
```
14. ビルドする

## ヘッダーのみライブラリの作成について
ヘッダーのみの場合、ライブラリ化する必要はないため、`.sln`がある階層にライブラリのフォルダを作成、その中に`include`フォルダを作成し、ヘッダーファイルをそこに作成する。

## GoogleTestを使用した単体テストを行う手順
1. ソリューションへ新しいプロジェクト`Google Test`をテストするプロジェクトの選択`テスト対象のプロジェクト`のみ変更し作成
2. Visual Studioから`test.cpp`を完全に削除
3. 作成したプロジェクトの`.vcxproj`と同じ階層にC++ファイルを`テスト対象_test`のように名前を付け作成
4. 作成したプロジェクトから`追加->既存の項目`で作成したC++ファイルを追加
5. 作成したプロジェクトのプロパティから、`構成プロパティ->VC++ディレクトリ`を選択、構成が`すべての構成`、プラットフォームが`x64` になっていることを確認し以下を変更
   1. `インクルードディレクトリ`を編集し、以下を追加
      1. `$(SolutionDir)`
      2. DirectXTK12を使う場合は、`$(SolutionDir)directxtk12\include\`
      3. DirectX12関連の配布されているヘルパー関数を使う場合は、`$(SolutionDir)directx12_helper\include\`
   2. `ライブラリディレクトリ`を編集し、以下を追加
      1. `$(SolutionDir)$(Platform)\$(Configuration)\`
      2. DirectXTK12を使う場合は、`$(SolutionDir)directxtk12\bin\$(Platform)\$(Configuration)\`
6. 作成したプロジェクトのプロパティから、`構成プロパティ->全般`を選択、構成が`すべての構成`、プラットフォームが`x64` になっていることを確認し以下を変更
   1. `C++言語標準`を`C++17`に変更
7. 作成したC++ファイルに`#include "pch.h"`を追加
8. テスト対象のライブラリのヘッダーをインクルードする
9. テスト対象のライブラリのlibを`#pragma comment("lib", "ライブラリ名.lib")`でリンクさせる
10. TESTマクロを使用し、テストを作成後、作成したプロジェクトを実行する

## ファイルのエンコード
日本語でのコメントをGithubウェブサイト上で確認したいため、`UTF-8 with BOM`の形式で保存する。VSCodeの場合、設定から`Files: Encoding`を検索し、`UTF-8 with BOM`に変更することで、VSCodeのエクスプローラーからファイルを作成すれば自動的に`UTF-8 with BOM`の形式で作成してくれるので便利。

## インタフェースファイルの場所
インタフェースを作る場合は、そのファイル内にはインタフェースと構造体や列挙体のみにし、実装クラスは作成しない。また、ファイルは`.sln`ファイルがある階層にある`wb_interface`フォルダもしくは`bdc_interface`内に作成すること。名前の通りインタフェースがwbのものなら`wb_interface`に、bdcのものなら`bdc_interface`に。

## 命名規則
- プロジェクト名(ライブラリ名もしくはモジュール名)は種類に応じて先頭に以下を付けたスネークケース
  - Engine部分(Windows Graphicアプリケーション部分)に当たる部分はwb(wb_console_log)
  - Game部分に当たる部分はbdc(bdc_object)
- ファイル名、名前空間名はスネークケース(snake_case)
- クラス、構造体、列挙型、関数はパスカルケース(PascalCase)
- インタフェースは先頭に`I`を付ける
- マクロ、定数はすべて大文字のスネークケース(SNAKE_CASE)
- クラスや構造体のメンバ変数はキャメルケース+アンダーバー(camelCase_)
- ローカル変数はキャメルケース(camelCase)
- 配列は配列と分かるよう複数形で(camelCases)
- 真偽値を表す変数の名称は`if オブジェクト名 名称`を満たすようにする
- グローバル変数には先頭に`g`を付ける

## コーディングルール
- コメントは日本語で書いてよい
- 各クラスの作成時には必ず名前空間を使用する
  - Engine部分(Windows Graphicアプリケーション部分)に当たる部分は`wb`(Windows Base)を使用する
  - Game部分に当たる部分は`bdc`を使用する
- 今回のプロジェクトで作成した名前空間らはusingせずに、必ず名前空間::クラス名のような形で使用する(wb::IContainer)
- usingはヘッダーファイルでは行わない
- プリコンパイル済みヘッダーファイルはヘッダーファイルでインクルードしてはいけない
- プリプロセッサ(`#ifdef`, `pragma`など)は必ずインデントはせずに、左端に置く
- インクルードは必ず.slnファイルのある階層からのものに(wb_container/include/static_container.h)
  - ただしGoogle Testプロジェクトのpchファイルのインクルードは`#include "pch.h"`で良く、test用のcppファイルらはプロジェクトファイルと同じ階層で良い。
  - 例(wb_container/include/static_container.h)のようにするため、ヘッダーファイルは`include`フォルダ、ソースファイルは`src`フォルダに配置する
- `wb_utility/include/console_log.h`や`wb_utility/include/error_handler.h`を使用し、エラー時の処理を行う
- Utility関数を作成する場合、`wb_utility`プロジェクトにヘッダー及びソースファイルを追加し、作成する

## ブランチの命名規則
- ブランチ名の先頭にそのブランチがやることを表すタグを、スネークケースで追加
  - 機能 : `feature/`
  - リファクタリング : `refactor/`
- タグの次には自身の名前をローマ字でスネークケースで追加
  - `feature/tarou_tanaka/`
- ブランチで行うことをスネークケースで追加
  - `feature/tarou_tanaka/static_container`
